@startuml Medium Detail WEC-Grid Workflow
!theme plain
skinparam backgroundColor white
skinparam activityBackgroundColor lightblue
skinparam activityBorderColor black
skinparam dpi 300
scale 0.9

start

:User creates Engine instance;
:Load grid case\n(IEEE test system or custom .RAW);

fork
    :Initialize PSS®E backend;
fork again
    :Initialize PyPSA backend;
end fork

:Configure WEC farm parameters\n(size, location, model);

if (WEC simulation data exists?) then (yes)
    :Load cached WEC results\nfrom database;
else (no)
    :Run WEC-Sim simulation\nin MATLAB;
    :Store results in SQLite DB;
endif

:Add WEC farm to\npower system models;

:Generate load curves\n(if requested);

:Run time-series simulation;

fork
    :PSS®E power flow analysis;
fork again
    :PyPSA power flow analysis;
end fork

:Store simulation results;

if (plot requested?) then (yes)
    :Generate visualization plots;
    :Compare backend results;
endif

:Return simulation summary;

stop

@enduml
